import pandas as pd
from PyQt5.QtWidgets import (
    QDialog,
    QVBoxLayout,
    QTableWidget,
    QTableWidgetItem,
    QPushButton,
)

class TableDialog(QDialog):
    def __init__(self, json_data):
        super().__init__()
        self.setWindowTitle("Data Table")
        self.setGeometry(200, 200, 600, 400)
        layout = QVBoxLayout(self)
        self.table_widget = QTableWidget()
        layout.addWidget(self.table_widget)
        self.populate_table(json_data)

    def populate_table(self, json_data):
        df = pd.read_json(json_data)
        self.table_widget.setRowCount(df.shape[0])
        self.table_widget.setColumnCount(df.shape[1])
        self.table_widget.setHorizontalHeaderLabels(df.columns)
        for i in range(df.shape[0]):
            for j in range(df.shape[1]):
                item = QTableWidgetItem(str(df.iloc[i, j]))
                self.table_widget.setItem(i, j, item)
        self.table_widget.resizeColumnsToContents()
        self.table_widget.resizeRowsToContents()

def show_table_popup(json_data):
    dialog = TableDialog(json_data)
    dialog.exec_()

# Button to open the popup
# Assumes 'self.json_data' is a JSON string of the DataFrame
self.button = QPushButton("Show Table")
self.button.clicked.connect(lambda: show_table_popup(self.json_data))
